# 下载器使用说明

## 📋 项目简介

一个自动化的发票下载工具，支持从票根网批量下载ETC发票，并自动解压整理。

交流学习目的制作！！！！！！！！！！！

## 🛠 环境要求

- Windows 操作系统
- Google Chrome 浏览器
- 稳定的网络连接

## 📥 下载使用

### 方式一：直接下载（推荐新手）
前往 [Releases页面](https://github.com/你的用户名/仓库名/releases) 下载最新版的 `InvoiceDownloader.exe`

### 方式二：从源码运行

## 🚀 使用步骤

### 第一步：以调试模式启动Chrome浏览器

！！首次使用会自动下载浏览器驱动，浏览器连接会很慢，没报错就没卡死，谅解

1. **关闭所有Chrome窗口**

   - 确保没有正在运行的Chrome进程

2. **以调试模式启动Chrome**

   - 按 `Win + R`键，输入 `cmd`打开命令提示符

   - 复制并运行以下命令：

     

     ```
     "你的chrome.exe,文件地址" --remote-debugging-port=9222 --user-data-dir="C:\ChromeDebug"
     示例：
     "C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-port=9222 --user-data-dir="C:\ChromeDebug"
     
     "C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-port=9222 --remote-allow-origins=* --user-data-dir="C:\Temp\ChromeDebugProfile"#第一个代码打开不了端口时使用，或者直接用这个
     ```

### 第二步：登录票根网

1. **访问票根网**
   - 在刚刚启动的调试模式Chrome浏览器中访问：
   - https://pss.txffp.com
2. **完成登录**
   - 使用你的账号密码登录
   - 确保能够正常查看发票信息

### 第三步：运行下载程序

1. **运行下载器**

   - 双击运行 `InvoiceDownloader.exe`

2. **选择下载模式**

   复制

   ```
   请选择下载模式:
   1. 单个月份下载
   2. 多个月份批量下载  
   3. 连续月份范围下载
   4. ptf解压
   ```

### 下载模式说明

#### 📅 模式1：单个月份下载

- 输入格式：`YYYYMM`（如：202410）
- 下载指定月份的发票

#### 📊 模式2：多个月份批量下载

- 输入格式：用逗号或空格分隔（如：202410,202411,202412）
- 批量下载多个指定月份的发票

#### 📈 模式3：连续月份范围下载

- 输入起始月份和结束月份（如：202401 到 202412）
- 下载连续月份的发票

#### 📦 模式4：ptf解压

#### #通常情况下载完自己会解压，特殊情况没有解压的使用，

- 自动解压已下载的发票压缩包
- 会跳过trans.pdf文件

## 📁 文件结构

程序运行后会创建以下目录结构：

复制

```
invoice_downloads/
├── 202410/          # 按月份组织的文件夹
│   ├── 发票文件.zip
│   └── 202410_发票统计.txt
├── 202411/
└── ...
```

## ⚠️ 注意事项

### 重要提醒

1. **不要关闭调试Chrome窗口**：下载过程中必须保持调试模式Chrome运行
2. **网络稳定性**：确保网络连接稳定，避免下载中断
3. **登录状态**：确保在调试Chrome中已登录票根网且会话未过期
4. **磁盘空间**：确保有足够的磁盘空间存储下载的发票
5. 下载完最好对一下！！！！

### 常见问题

- **Q: 程序提示"浏览器连接失败"**
  - A: 检查Chrome是否以调试模式启动，端口是否为9222
- **Q: 下载的发票数量为0**
  - A: 检查指定月份是否有发票，以及登录状态是否正常
- **Q: 解压失败**
  - A: 检查磁盘空间是否充足，文件是否下载完整

### 安全提示

🔒 **个人信息保护**

- 本工具仅在本地运行，不会上传任何数据
- 下载的发票文件保存在本地，请妥善保管
- 使用后及时清理调试模式Chrome的用户数据

## 🆘 故障排除

### 如果遇到问题：

1. 重新启动调试模式Chrome
2. 确认登录状态有效
3. 检查网络连接
4. 查看程序输出的错误信息

### 技术支持

- 可以去问ai
- 我基本不回消息而且我很菜，问我我也是去问ai